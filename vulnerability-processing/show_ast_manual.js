// helper script to show AST in format needed by finder.js

const finder = require("./finder");


const inputAst = finder.tryParse(``);
const patchAst = finder.tryParse(``);

const title = "Title";
const description = "Description";
const severity = 2;
const referenceUrl = "Advisory url";

var patchAstHash = finder.hash.MD5(patchAst);


console.log(JSON.stringify({
    "title": title,
    "description": description,
    "reference_url": referenceUrl,
    "severity": parseInt(severity),
    "ast": inputAst,
    "patch": patchAstHash,
}, (k, v) => (k === 'start' || k === 'end' || k === 'sourceType') ? undefined : v));

console.log(JSON.stringify({
    "id": patchAstHash,
    "patch": patchAst,
}, (k, v) => (k === 'start' || k === 'end' || k === 'sourceType') ? undefined : v));